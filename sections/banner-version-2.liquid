<script src="{{ 'banner-version-2.js' | asset_url }}" defer="defer"></script>

<style>
  a{text-decoration:none}.banner-area-two{margin-top:{{section.settings.mt}}px;margin-bottom:{{section.settings.mb}}px;position:relative;width:100%;max-width:100%}.banner-top-content{max-width:1310px;margin:0 auto;padding:8px 0;text-align:center;justify-content:center}.banner-top-content-item{padding:0 18px;text-align:center}.banner-top-content-item span i{font-size:14px;color:#1e1e1e;margin-right:10px}.banner-top-content-item span{font-size:13px;text-transform:uppercase;font-weight:400;font-family:Pragmatica,sans-serif}.banner-img{position:relative}.video-wrapper video{height:100%;width:100%}.banner-main-content{position:absolute;bottom:15%;text-align:center;left:50%;right:50%;max-width:750px;width:100%;transform:translate(-50%);z-index:10}.banner-main{position:relative;height:43vw;max-height:700px;background-size:cover;background-repeat:no-repeat;background-position:center;overflow:hidden}.banner-btn a{font-weight:700;display:inline-flex;justify-content:center;margin-top:30px;align-items:center;border-radius:5px;line-height:1;cursor:pointer;text-decoration:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;min-width:7.6rem;font-weight:700}.banner-bottom{padding:20px 0}.banner-bottm-content{max-width:890px;padding:0 50px;justify-content:space-between;margin:0 auto;display:flex;align-items:center}.banner-brand-img{max-width:230px}.banner-top{padding:6px 0}.banner-top-item{text-align:center}.banner-top-item p{display:inline-flex;align-items:center;gap:10px;font-family:sans-serif}@media (min-width:1024px) and (max-width:1200px){.banner-main-content{right:4%}}@media (min-width:750px) and (max-width:1023px){.banner-main-content{right:5%}.banner-main-content h3{font-size:2rem;margin-bottom:10px}.banner-btn a{margin-top:15px}}@media only screen and (max-width:749px){.banner-main-content{text-align:center;right:0;bottom:0;top:60%;left:50%;transform:translate(-50%,-50%);width:100%;padding:0 16px}.banner-main-content h3{font-size:2rem}.banner-main{height:140vw;max-height:650px;background-position:inherit}.banner-main-content h3{font-size:1.5rem;margin-bottom:10px}.banner-btn a{margin-top:15px}.banner-bottm-content{padding:0 5px;gap:8px}}@media only screen and (max-width:768px){.banner-area-two{margin-top:{{section.settings.mt_mobile}}px;margin-bottom:{{section.settings.mb_mobile}}px}.banner-main-content h3{font-size:2rem}}.banner-top-content-item span{display:flex;align-items:center;gap:10px;justify-content:center}.banner-top-content-item span svg{width:9px;height:8px}.banner-brand-img img{max-height:46px;height:100%}.mobile-video{display:none}@media only screen and (min-width:1300px){.banner-brand-img img{max-height:73px;height:100%}}@media (max-width:768px){.desktop-video{display:none}.mobile-video{display:block}}.b_overlay::after{position:absolute;content:"";inset:0;background-color:{{section.settings.image_overlay_color}};opacity:{{section.settings.image_overlay_opacity | divided_by:100}};pointer-events:none;z-index:1}@media only screen and (max-width:768px){.b_overlay::after{opacity:{{section.settings.image_overlay_opacity_mobile | divided_by:100}}}}

  .video-wrapper {
    position: relative;
    width: 100%;
    height: auto;
  }

  /* LCP image sits under videos */
  .lcp-image {
    display: block;
    width: 100%;
    height: auto;
  }

  /* Videos overlay the image */
  .desktop-video,
  .mobile-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Show desktop video on desktop, hide mobile video */
  .desktop-video {
    display: block;
  }
  .mobile-video {
    display: none;
  }

  /* Show mobile video on mobile, hide desktop video */
  @media (max-width: 767px) {
    .desktop-video {
      display: none;
    }
    .mobile-video {
      display: block;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var queue = new createjs.LoadQueue();
    var isMobile = window.matchMedia('(max-width: 767px)').matches;

    const desktopVideo = document.querySelector('.desktop-video');
    const mobileVideo = document.querySelector('.mobile-video');

    // Helper to load and play video if src is valid
    function loadAndPlay(videoEl, src) {
      if (!src || src.trim() === '') return; // Skip if empty
      videoEl.querySelector('source').src = src;
      videoEl.load();
      videoEl.style.display = 'block';
      videoEl.play().catch((err) => console.log('Autoplay blocked:', err));
    }

    // PreloadJS fileload
    queue.on('fileload', function (event) {
      if (isMobile && event.item.id === 'mobile') {
        loadAndPlay(mobileVideo, event.item.src);
      } else if (!isMobile && event.item.id === 'desktop') {
        loadAndPlay(desktopVideo, event.item.src);
      }
    });

    // Load only the relevant video
    if (isMobile) {
      queue.loadFile({ id: 'mobile', src: '{{ section.settings.u_mobile }}' });
    } else {
      queue.loadFile({ id: 'desktop', src: '{{ section.settings.u }}' });
    }
  });
</script>

<div class="banner-area-two m-color-{{ section.settings.color_scheme }}">
  <div class="banner-top">
    <div class="rs-container">
      <div class="swiper banner-top-active">
        <div class="swiper-wrapper">
          {% for block in section.blocks %}
            <div class="banner-top-item swiper-slide">
              <p class="{{ section.settings.top_text }}">
                <svg
                  class="icon icon-checkmark"
                  width="9"
                  height="8"
                  viewBox="0 0 9 8"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M7.85766 0.48999L7.29266 1.05999C5.76017 2.59562 4.5901 3.87807 3.1677 5.33007L1.6527 4.05007L1.0427 3.53506L0.0126953 4.75506L0.622695 5.27506L2.7027 7.03506L3.2627 7.51007L3.7827 6.99007C5.5059 5.26319 6.73278 3.88383 8.4227 2.19007L8.98769 1.62007L7.85766 0.48999Z" fill="currentColor"></path>
                </svg>
                {{ block.settings.top_item }}
              </p>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  <div
    class="banner-main {% if section.settings.b_overlay != false %}b_overlay{% endif %}"
    style="{% if section.settings.bg_igm != blank %} background-image: url('{{ section.settings.bg_igm |  img_url: 'master'  }}'); {% endif %}"
  >
    <div class="video-wrapper">
      <!-- LCP Image (shows immediately for faster LCP) -->
      <img
        class="lcp-image"
        src="https://cdn.shopify.com/s/files/1/0018/5329/2643/files/Background-desktop__1_.jpg_V1_1_2_60866071-e175-40ea-bf6e-b283ad4fc52b.webp?v=1757623772"
        alt="Banner image"
        fetchpriority="high"
        width="1920"
        height="1080"
      >

      <!-- Desktop Video -->
      <video
        class="desktop-video"
        muted
        autoplay
        loop
        playsinline
        fetchpriority="high"
        poster="https://cdn.shopify.com/s/files/1/0018/5329/2643/files/Background-desktop__1_.jpg_V2_dc7d4c96-f9fb-4cce-b580-c1c4b70846c1_2_1_3.webp?v=1757618603"
      >
        <source src="{{ section.settings.u }}" type="video/mp4">
      </video>

      <!-- Mobile Video -->
      <video
        class="mobile-video"
        muted
        autoplay
        loop
        playsinline
        fetchpriority="high"
        poster="https://cdn.shopify.com/s/files/1/0018/5329/2643/files/Background-desktop__1_.jpg_V1_1_2_60866071-e175-40ea-bf6e-b283ad4fc52b.webp?v=1757623772"
      >
        <source src="{{ section.settings.u_mobile }}" type="video/mp4">
      </video>
    </div>

    <div class="banner-main-content">
      <h1 class="{{ section.settings.heading_type }}">{{ section.settings.title }}</h1>
      <div class="m:text-color-subtext {{ section.settings.sub_title_text }}">{{ section.settings.sub_title }}</div>
      <div class="banner-btn banner-btn-{{ section.id }}">
        <a
          class="m-button {{ section.settings.button_style }} {{ section.settings.button_size }}"
          href="{{ section.settings.btn_link }}"
        >
          {{- section.settings.btn_text -}}
        </a>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "APEX Banner Version 2",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme"
    },
    {
      "type": "text",
      "id": "u",
      "label": "Video URL",
      "default": "https://cdn.shopify.com/videos/c/o/v/bfddd4ffc23e4801bb72eb108dadbd31.mp4"
    },

    {
      "type": "text",
      "id": "u_mobile",
      "label": "Video URL",
      "default": "https://cdn.shopify.com/videos/c/o/v/aa429ef4f1a64d94bffd7e063a8de73e.mp4"
    },

    {
      "type": "range",
      "id": "mt",
      "label": "Margin Top",
      "default": 0,
      "min": 0,
      "max": 100,
      "step": 1
    },
    {
      "type": "range",
      "id": "mb",
      "label": "Margin Bottom",
      "default": 0,
      "min": 0,
      "max": 100,
      "step": 1
    },
    {
      "type": "range",
      "id": "mt_mobile",
      "label": "Margin Top (Mobile)",
      "default": 0,
      "min": 0,
      "max": 100,
      "step": 1
    },
    {
      "type": "range",
      "id": "mb_mobile",
      "label": "Margin Bottom (Mobile)",
      "default": 0,
      "min": 0,
      "max": 100,
      "step": 1
    },
    {
      "type": "header",
      "content": "Top Item Text Settings"
    },
    {
      "type": "header",
      "content": "Select Paragraph size"
    },
    {
      "type": "select",
      "id": "top_text",
      "label": "Paragraph Size",
      "default": "p-medium",
      "options": [
        { "value": "p-xl", "label": "Extra Large" },
        { "value": "p-large", "label": "Large" },
        { "value": "p-medium", "label": "Medium" },
        { "value": "p-small", "label": "Small" },
        { "value": "p-x-small", "label": "Extra Small" }
      ]
    },
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Valentineâ€™s Sale"
    },
    {
      "type": "select",
      "id": "heading_type",
      "label": "Choose Heading Size",
      "options": [
        {
          "value": "mrk-h1",
          "label": "H1"
        },
        {
          "value": "mrk-h2",
          "label": "H2"
        },
        {
          "value": "mrk-h3",
          "label": "H3"
        },
        {
          "value": "mrk-h4",
          "label": "H4"
        },
        {
          "value": "mrk-h5",
          "label": "H5"
        },
        {
          "value": "mrk-h6",
          "label": "H6"
        }
      ],
      "default": "mrk-h1"
    },

    {
      "type": "header",
      "content": "Sub heading"
    },
    {
      "type": "richtext",
      "id": "sub_title",
      "label": "Sub Title",
      "default": "<p>20% off with code <strong>VDAY20</strong></p>"
    },
    {
      "type": "header",
      "content": "Select Sub heading size"
    },
    {
      "type": "select",
      "id": "sub_title_text",
      "label": "Paragraph Size",
      "default": "p-medium",
      "options": [
        { "value": "p-xl", "label": "Extra Large" },
        { "value": "p-large", "label": "Large" },
        { "value": "p-medium", "label": "Medium" },
        { "value": "p-small", "label": "Small" },
        { "value": "p-x-small", "label": "Extra Small" }
      ]
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "btn_text",
      "label": "Button Text",
      "default": "shop now"
    },

    {
      "type": "url",
      "id": "btn_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button style",
      "options": [
        {
          "value": "m-button--primary",
          "label": "Primary button"
        },
        {
          "value": "m-button--secondary",
          "label": "Secondary button"
        },
        {
          "value": "m-button--white",
          "label": "White button"
        },
        {
          "value": "m-button--link",
          "label": "Underline button"
        }
      ],
      "default": "m-button--primary"
    },
    {
      "type": "select",
      "id": "button_size",
      "label": "Button size",
      "options": [
        {
          "value": "m-button--small",
          "label": "Button small"
        },
        {
          "value": "",
          "label": "Button medium"
        },
        {
          "value": "m-button--large",
          "label": "Button large"
        }
      ],
      "default": ""
    },
    {
      "type": "header",
      "content": "overlay Settings"
    },
    {
      "type": "checkbox",
      "id": "b_overlay",
      "label": "Add OverLay",
      "default": false
    },
    {
      "type": "color",
      "id": "image_overlay_color",
      "label": "Overlay Background Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "image_overlay_opacity",
      "label": "Overlay Opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 50
    },
    {
      "type": "range",
      "id": "image_overlay_opacity_mobile",
      "label": "Overlay Opacity (Mobile)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 30
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Top Item",
      "settings": [
        {
          "type": "text",
          "id": "top_item",
          "label": "Top Item Text",
          "default": "100% Money Back"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "APEX Banner Version 2"
    }
  ]
}
{% endschema %}
